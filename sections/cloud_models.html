<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Cloud Models &#8212; BeAR 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=5bc47236" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=359c27e9"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Stellar spectra" href="stellar_spectra.html" />
    <link rel="prev" title="Chemistry Models" href="chemistry_models.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="cloud-models">
<span id="sec-cloud-models"></span><h1>Cloud Models<a class="headerlink" href="#cloud-models" title="Permalink to this heading">¶</a></h1>
<p>BeAR currently includes the following cloud descriptions:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#sec-cloud-model-grey"><span class="std std-ref">Grey cloud layer</span></a></p></li>
<li><p><a class="reference internal" href="#sec-cloud-model-kh"><span class="std std-ref">Non-grey cloud fit</span></a> from
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018MNRAS.475...94K/">Kitzmann &amp; Heng (2018)</a></p></li>
<li><p><a class="reference internal" href="#sec-cloud-model-power-law"><span class="std std-ref">Power law cloud layer</span></a></p></li>
</ul>
</div></blockquote>
<p>The code also supports the <a class="reference internal" href="#sec-cloud-model-mixing"><span class="std std-ref">mixing of different cloud models</span></a> in a single retrieval.</p>
<section id="grey-cloud-model">
<span id="sec-cloud-model-grey"></span><h2>Grey Cloud Model<a class="headerlink" href="#grey-cloud-model" title="Permalink to this heading">¶</a></h2>
<p>The grey cloud layer model is the most simple cloud parametrisation available in BeAR.
It puts a cloud layer with a certain geometric height and a wavelength-independent
optical depth into the atmosphere. It is selected by using the keyword
<code class="code docutils literal notranslate"><span class="pre">grey</span></code> in the corresponding section in the <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Cloud model</span>
<span class="n">grey</span>
</pre></div>
</div>
<p>The location of the cloud layer is set by a cloud top pressure <span class="math notranslate nohighlight">\(p_\mathrm{top}\)</span>
that is one of the free parameters of the model. The cloud bottom pressure
<span class="math notranslate nohighlight">\(p_\mathrm{bot}\)</span> is determined by a free parameter <span class="math notranslate nohighlight">\(b\)</span>, such that
<span class="math notranslate nohighlight">\(p_\mathrm{bot} = p_\mathrm{top} \, b\)</span>. The optical depth is divided between all
atmospheric layers that lie between these two pressures.</p>
<p>A grey cloud model has in total three free parameters that have to be added to the prior config
file in the following order:</p>
<blockquote>
<div><ul class="simple">
<li><p>(vertical) grey optical depth</p></li>
<li><p>cloud top pressure in bar</p></li>
<li><p>cloud bottom parameter <span class="math notranslate nohighlight">\(b\)</span></p></li>
</ul>
</div></blockquote>
<p>It is sometimes not possible to constrain the bottom of the cloud deck properly.
This is often the case when performing retrieval calculations for a transmission spectrum.
In this case, BeAR has the option to use a fixed cloud bottom. This can be enabled by
using the optional parameter <code class="code docutils literal notranslate"><span class="pre">fb</span></code> after the cloud model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Cloud model</span>
<span class="n">grey</span> <span class="n">fb</span>
</pre></div>
</div>
<p>By choosing this option, BeAR fixes the cloud bottom pressure at one atmospheric scale height
below the cloud top. In this case, only two free parameters are required in the prior file:</p>
<blockquote>
<div><ul class="simple">
<li><p>(vertical) grey optical depth</p></li>
<li><p>cloud top pressure in bar</p></li>
</ul>
</div></blockquote>
</section>
<section id="kitzmann-heng-non-grey-cloud-model">
<span id="sec-cloud-model-kh"></span><h2>Kitzmann &amp; Heng Non-Grey Cloud Model<a class="headerlink" href="#kitzmann-heng-non-grey-cloud-model" title="Permalink to this heading">¶</a></h2>
<p>This description of a non-grey cloud layer is based on analytical fits to the Mie efficiencies
of the cloud particles presented by
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018MNRAS.475...94K/">Kitzmann &amp; Heng (2018)</a>.
The Mie extinction efficiences as a function of wavelength <span class="math notranslate nohighlight">\(Q_\mathrm{ext}\)</span>
are described via:</p>
<div class="math notranslate nohighlight">
\[Q_\mathrm{ext}(\lambda) = \frac{Q_1}{Q_0 x^{-a_0}_\lambda + x^{0.2}_\lambda} ,\]</div>
<p>where <span class="math notranslate nohighlight">\(x_\lambda\)</span> is the wavelength-dependent size parameter of the cloud particles,
<span class="math notranslate nohighlight">\(Q_1\)</span> is a normalisation constant, <span class="math notranslate nohighlight">\(Q_0\)</span> determines the <span class="math notranslate nohighlight">\(x_\lambda\)</span> value
at which <span class="math notranslate nohighlight">\(Q_\mathrm{ext}\)</span> is peaking, and <span class="math notranslate nohighlight">\(a_0\)</span> is the powerlaw index in the
small particle limit, where Mie theory converges to the limit of Rayleigh scattering.
The size parameter is a function of the particle radius <span class="math notranslate nohighlight">\(a\)</span> and the wavelength:</p>
<div class="math notranslate nohighlight">
\[x_\lambda = 2 \pi a / \lambda .\]</div>
<p>The optical depth <span class="math notranslate nohighlight">\(\tau_\lambda\)</span> of the cloud is determined based on the
number density of cloud particles <span class="math notranslate nohighlight">\(n_c\)</span> and the vertical extent of the cloud
<span class="math notranslate nohighlight">\(\Delta z\)</span>:</p>
<div class="math notranslate nohighlight">
\[\tau(\lambda) = Q_\mathrm{ext}(\lambda) \pi a^2 n_c \Delta z .\]</div>
<p>Since, however, it is usually difficult to put good priors on the number density
<span class="math notranslate nohighlight">\(n_c\)</span>, BeAR instead uses the vertical optical depth at a reference wavelength
<span class="math notranslate nohighlight">\(\lambda_\mathrm{ref}\)</span> to describe the optical depths as a function of wavelength:</p>
<div class="math notranslate nohighlight">
\[\tau(\lambda) = \tau(\lambda_\mathrm{ref})
\frac{Q_\mathrm{ext}(\lambda)}{Q_\mathrm{ext}(\lambda_\mathrm{ref})}
= \tau(\lambda_\mathrm{ref})
  \frac{Q_0 x^{-a_0}_{\lambda_{\mathrm{ref}}} + x^{0.2}_{\lambda_\mathrm{ref}}}{Q_0 x^{-a_0}_\lambda + x^{0.2}_\lambda}  .\]</div>
<p>By using the reference optical depth, the normalisation constant <span class="math notranslate nohighlight">\(Q_1\)</span> is not required anymore.</p>
<p>The non-grey cloud description is selected by using the keyword
<code class="code docutils literal notranslate"><span class="pre">KHnongrey</span></code>, followed by the reference wavelength in <span class="math notranslate nohighlight">\(\mu\mathrm{m}\)</span>
in the corresponding section in the <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Cloud model</span>
<span class="n">KHnongrey</span> <span class="mf">1.0</span>
</pre></div>
</div>
<p>The reference wavelength does not need to be within the wavelength range of the
retrieval calculations.</p>
<p>A non-grey cloud model has in total six free parameters that have to be added to the prior config
file in the following order:</p>
<blockquote>
<div><ul class="simple">
<li><p>(vertical) optical depth at the reference wavelength</p></li>
<li><p><span class="math notranslate nohighlight">\(Q_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a_0\)</span></p></li>
<li><p>particle size <span class="math notranslate nohighlight">\(a\)</span></p></li>
<li><p>cloud top pressure in bar</p></li>
<li><p>cloud bottom parameter <span class="math notranslate nohighlight">\(b\)</span></p></li>
</ul>
</div></blockquote>
<p>The location of the cloud layer is set by a cloud top pressure <span class="math notranslate nohighlight">\(p_\mathrm{top}\)</span>
that is one of the free parameters of the model. The cloud bottom pressure
<span class="math notranslate nohighlight">\(p_\mathrm{bot}\)</span> is determined by a free parameter <span class="math notranslate nohighlight">\(b\)</span>, such that
<span class="math notranslate nohighlight">\(p_\mathrm{bot} = p_\mathrm{top} \, b\)</span>. The optical depth is divided between all
atmospheric layers that lie between these two pressures.</p>
<p>It is sometimes not possible to constrain the bottom of the cloud deck properly.
This is often the case when performing retrieval calculations for a transmission spectrum.
In this case, BeAR has the option to use a fixed cloud bottom. This can be enabled by
using the optional parameter <code class="code docutils literal notranslate"><span class="pre">fb</span></code> after the cloud model and the reference wavelength:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Cloud model</span>
<span class="n">KHnongrey</span> <span class="mf">1.0</span> <span class="n">fb</span>
</pre></div>
</div>
<p>By choosing this option, BeAR fixes the cloud bottom pressure at one atmospheric scale height
below the cloud top. In this case, only five free parameters are required in the prior file:</p>
<blockquote>
<div><ul class="simple">
<li><p>(vertical) optical depth at the reference wavelength</p></li>
<li><p><span class="math notranslate nohighlight">\(Q_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a_0\)</span></p></li>
<li><p>particle size <span class="math notranslate nohighlight">\(a\)</span></p></li>
<li><p>cloud top pressure in bar</p></li>
</ul>
</div></blockquote>
</section>
<section id="power-law-cloud-model">
<span id="sec-cloud-model-power-law"></span><h2>Power-Law Cloud Model<a class="headerlink" href="#power-law-cloud-model" title="Permalink to this heading">¶</a></h2>
<p>This cloud model uses a power law to describe the wavelength-dependent optical depth of
the cloud layer. It uses the optical depth at a reference wavelength as normalisation:</p>
<div class="math notranslate nohighlight">
\[\tau(\lambda) = \tau(\lambda_\mathrm{ref}) \frac{\lambda^e}{\lambda_\mathrm{ref}^e} ,\]</div>
<p>where <span class="math notranslate nohighlight">\(e\)</span> is the exponent of the power law. To simulate Rayleigh scattering, for
example, <span class="math notranslate nohighlight">\(e=-4\)</span>.</p>
<p>The power-law cloud model is selected by using the keyword
<code class="code docutils literal notranslate"><span class="pre">power_law</span></code>, followed by the reference wavelength in <span class="math notranslate nohighlight">\(\mu\mathrm{m}\)</span>
in the corresponding section in the <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Cloud model</span>
<span class="n">power_law</span> <span class="mf">1.0</span>
</pre></div>
</div>
<p>The reference wavelength does not need to be within the wavelength range of the
retrieval calculations.</p>
<p>A non-grey cloud model has in total four free parameters that have to be added to the prior config
file in the following order:</p>
<blockquote>
<div><ul class="simple">
<li><p>(vertical) optical depth at the reference wavelength</p></li>
<li><p>power-law exponent <span class="math notranslate nohighlight">\(e\)</span></p></li>
<li><p>cloud top pressure in bar</p></li>
<li><p>cloud bottom parameter <span class="math notranslate nohighlight">\(b\)</span></p></li>
</ul>
</div></blockquote>
<p>The location of the cloud layer is set by a cloud top pressure <span class="math notranslate nohighlight">\(p_\mathrm{top}\)</span>
that is one of the free parameters of the model. The cloud bottom pressure
<span class="math notranslate nohighlight">\(p_\mathrm{bot}\)</span> is determined by a free parameter <span class="math notranslate nohighlight">\(b\)</span>, such that
<span class="math notranslate nohighlight">\(p_\mathrm{bot} = p_\mathrm{top} \, b\)</span>. The optical depth is divided between all
atmospheric layers that lie between these two pressures.</p>
<p>It is sometimes not possible to constrain the bottom of the cloud deck properly.
This is often the case when performing retrieval calculations for a transmission spectrum.
In this case, BeAR has the option to use a fixed cloud bottom. This can be enabled by
using the optional parameter <code class="code docutils literal notranslate"><span class="pre">fb</span></code> after the cloud model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Cloud model</span>
<span class="n">power_law</span> <span class="mf">1.0</span> <span class="n">fb</span>
</pre></div>
</div>
<p>By choosing this option, BeAR fixes the cloud bottom pressure at one atmospheric scale height
below the cloud top. In this case, only two three parameters are required in the prior file:</p>
<blockquote>
<div><ul class="simple">
<li><p>(vertical) optical depth at the reference wavelength</p></li>
<li><p>power-law exponent <span class="math notranslate nohighlight">\(e\)</span></p></li>
<li><p>cloud top pressure in bar</p></li>
</ul>
</div></blockquote>
</section>
<section id="mixing-different-cloud-models">
<span id="sec-cloud-model-mixing"></span><h2>Mixing different cloud models<a class="headerlink" href="#mixing-different-cloud-models" title="Permalink to this heading">¶</a></h2>
<p>BeAR also has the ability to use multiple clouds simultaneously. For example, to perform a retrieval with
grey cloud layer and a second cloud with a power-law optical depth to simulate, for example, a haze-like
behaviour, the following can be used as configuration in the <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Cloud model</span>
<span class="n">grey</span>
<span class="n">power_law</span> <span class="mf">1.0</span> <span class="n">fb</span>
</pre></div>
</div>
<p>BeAR will call the cloud models in the order they appear in this list. Clouds can also be overlapping
in pressure.</p>
<p>In the prior configuration file, the free parameters have to appear in the same order as the
cloud models listed in <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code>.</p>
<p>Thus, for the example above, the following priors need to be listed:</p>
<blockquote>
<div><ul class="simple">
<li><p>grey optical depth</p></li>
<li><p>cloud top pressure in bar</p></li>
<li><p>cloud bottom parameter</p></li>
<li><p>optical depth at the reference wavelength</p></li>
<li><p>power-law exponent</p></li>
<li><p>cloud top pressure in bar</p></li>
</ul>
</div></blockquote>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/bear.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">BeAR - The Bern Atmospheric Retrieval code</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=daniel-kitzmann&repo=bear&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="licence.html">Licence</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="opacity_data.html">Opacity data</a></li>
<li class="toctree-l1"><a class="reference internal" href="observations.html">Observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="forward_models.html">Forward Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="retrieval_setup.html">Setting up a retrieval</a></li>
<li class="toctree-l1"><a class="reference internal" href="temperature_profiles.html">Temperature profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemistry_models.html">Chemistry Models</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Cloud Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#grey-cloud-model">Grey Cloud Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#kitzmann-heng-non-grey-cloud-model">Kitzmann &amp; Heng Non-Grey Cloud Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#power-law-cloud-model">Power-Law Cloud Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mixing-different-cloud-models">Mixing different cloud models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stellar_spectra.html">Stellar spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="profile_parametrisations.html">Parametrisations of vertical profiles</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="chemistry_models.html" title="previous chapter">Chemistry Models</a></li>
      <li>Next: <a href="stellar_spectra.html" title="next chapter">Stellar spectra</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020 - 2024, Daniel Kitzmann.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/sections/cloud_models.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>