<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Forward Models &#8212; BeAR 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=5bc47236" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=359c27e9"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Setting up a retrieval" href="retrieval_setup.html" />
    <link rel="prev" title="Observations" href="observations.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="forward-models">
<span id="sec-forward-models"></span><h1>Forward Models<a class="headerlink" href="#forward-models" title="Permalink to this heading">¶</a></h1>
<p>BeAR currently includes the following forward models:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#sec-forward-model-transmission"><span class="std std-ref">Transmission spectrum</span></a></p></li>
<li><p>Emission spectrum</p></li>
<li><p>Secondary eclipse spectrum</p></li>
<li><p>Secondary eclipse spectra with a planetary blackbody</p></li>
<li><p><a class="reference internal" href="#sec-forward-model-flat"><span class="std std-ref">Flat line</span></a></p></li>
</ul>
</div></blockquote>
<p>The latter two models are usually used to check if the observational
data is more likely explained by more simpler models, such as a flat line.</p>
<p>Each model requires its own config file <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> that are
discussed below.</p>
<section id="flat-line">
<span id="sec-forward-model-flat"></span><h2>Flat line<a class="headerlink" href="#flat-line" title="Permalink to this heading">¶</a></h2>
<p>This model simply fits a flat line through the observational data. Usually, this
model is used to test if the use of a more complex model is warranted to explain
the observation. The test is normally done by comparing their
Bayesian evidences.</p>
<p>In the main retrieval config file <code class="docutils literal notranslate"><span class="pre">retrieval.config</span></code> it is selected by choosing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Forward model</span>
<span class="n">flat_line</span>
</pre></div>
</div>
<p>The flat line model does not need a <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> file since it
has no configurable parameters. In the prior distribution file, this model
requires a single free parameter that determines the flat line.</p>
<p>This parameter needs to have the same units as the observational data. For example,
in case of a transmission spectrum, this parameter refers to the transit depth in ppm, while
for an emission spectrum, it needs to have units of
<span class="math notranslate nohighlight">\(\mathrm{W} \mathrm{m^{-2}} \mathrm{\mu m^{-1}}\)</span>.</p>
</section>
<section id="transmission-spectrum">
<span id="sec-forward-model-transmission"></span><h2>Transmission spectrum<a class="headerlink" href="#transmission-spectrum" title="Permalink to this heading">¶</a></h2>
<p>This forward model computes the wavelength-dependent transit depth
<span class="math notranslate nohighlight">\(D(\lambda)\)</span> of an exoplanet atmosphere, given by</p>
<div class="math notranslate nohighlight">
\[D(\lambda) = \left(\frac{R_p(\lambda)}{R_*}\right)^2 \ ,\]</div>
<p>where <span class="math notranslate nohighlight">\(R_p(\lambda)\)</span> is the wavelength-dependent planetary radius
and <span class="math notranslate nohighlight">\(R_*\)</span> the radius of the host star. In BeAR, <span class="math notranslate nohighlight">\(D(\lambda)\)</span>
has units of ppm.</p>
<p>In the retrieval config file <code class="docutils literal notranslate"><span class="pre">retrieval.config</span></code> it is selected by choosing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Forward model</span>
<span class="n">transmission</span>
</pre></div>
</div>
<p>The transmission spectrum forward model has three general free parameters that
have to be added to the priors configuration file in the following order:</p>
<blockquote>
<div><ul class="simple">
<li><p>logarithm of surface gravity <span class="math notranslate nohighlight">\(\log g\)</span> in cgs units</p></li>
<li><p>planet radius in Jupiter radii</p></li>
<li><p>stellar radius in solar radii</p></li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> file for the transmission spectrum model has
the following structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Number of levels</span>
<span class="mi">150</span>

<span class="c1">#Bottom of atmosphere pressure (bar)</span>
<span class="mi">10</span>

<span class="c1">#Top of atmosphere pressure (bar)</span>
<span class="mf">1e-6</span>

<span class="c1">#Fit for mean molecular weight (mmw) or scale height (sh)</span>
<span class="n">no</span>

<span class="c1">#Temperature profile</span>
<span class="n">const</span>

<span class="c1">#Cloud model</span>
<span class="n">none</span>

<span class="c1">#Optional modules</span>
<span class="n">none</span>

<span class="c1">#Retrieved chemical species</span>
<span class="n">iso</span> <span class="n">H2O</span> <span class="n">TiO</span> <span class="n">VO</span> <span class="n">K</span>
<span class="n">bg</span>  <span class="n">H2He</span>

<span class="c1">#Opacity species&amp;folders</span>
<span class="n">CIA</span><span class="o">-</span><span class="n">H2</span><span class="o">-</span><span class="n">H2</span>   <span class="n">CIA</span><span class="o">/</span><span class="n">H2</span><span class="o">-</span><span class="n">H2</span>
<span class="n">CIA</span><span class="o">-</span><span class="n">H2</span><span class="o">-</span><span class="n">He</span>   <span class="n">CIA</span><span class="o">/</span><span class="n">H2</span><span class="o">-</span><span class="n">He</span>
<span class="n">H2</span>          <span class="n">Rayleigh</span>
<span class="n">He</span>          <span class="n">Rayleigh</span>
<span class="n">H2O</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">1</span><span class="n">H2</span><span class="o">-</span><span class="mi">16</span><span class="n">O__POKAZATEL_e2b</span>
<span class="n">TiO</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">48</span><span class="n">Ti</span><span class="o">-</span><span class="mi">16</span><span class="n">O__Toto_e2b</span>
<span class="n">VO</span>          <span class="n">Molecules</span><span class="o">/</span><span class="mi">51</span><span class="n">V</span><span class="o">-</span><span class="mi">16</span><span class="n">O__VOMYT_e2b</span>
</pre></div>
</div>
<p>The first three entries refer to the vertical discretisation of the atmosphere.
This includes the number of atmospheric layers as well as the bottom and
top-of-atmosphere pressures in units of bars.</p>
<p>With the next entry, the retrieval of the mean molecular or the scale height
can be chosen. Usually, BeAR will determine the mean molecular based on
the chemical abundances of the species included in the retrieval.
Sometimes, however, the background species in an atmosphere might not be
known. For such a case, BeAR can use the mean molecular weight as a free
parameter.</p>
<p>Furthermore, for transmission spectra, the surface gravity, the mean molecular
weight, and the temperature might become degenerate in a retrieval. This is
often the case when no constraints on the surface gravity can be provided
and the dominating background specise is not known. In such a scenario, BeAR
can use the (constant) atmospheric scale height in units of km as a free
parameter.</p>
<p>For the standard case, the keyword <code class="docutils literal notranslate"><span class="pre">no</span></code> needs to be used here. If BeAR should
use the mean molecular weight as a free parameter <code class="docutils literal notranslate"><span class="pre">mmw</span></code> is used, while
<code class="docutils literal notranslate"><span class="pre">sh</span></code> is used when the scale should be used as a free parameter instead. If either
the mean molecular weight or the scale height is chosen as a free parameter,
a corresponding prior needs to be added as a fourth model parameter in the
prior configuration file.</p>
<p>With the next two entries, the parametrisation for the
<a class="reference internal" href="temperature_profiles.html#sec-temperature-profiles"><span class="std std-ref">temperature profile</span></a> and
the <a class="reference internal" href="cloud_models.html#sec-cloud-models"><span class="std std-ref">cloud models</span></a> are set. After than, optional
modules can be added to the forward model.</p>
<p>Finally, the different <a class="reference internal" href="chemistry_models.html#sec-chemistry-models"><span class="std std-ref">chemistry models</span></a>, chemical species, and the
<a class="reference internal" href="opacity_data.html#sec-opacity-data"><span class="std std-ref">opacity sources</span></a> are selected. It is important to note that
chemical species that are used as part of the chemistry models, should normally also have
an associated opacity source. Otherwise, the impact of that species on the
resulting spectrum might be negligible and, therefore, its abundance will be
likely be unconstrained.</p>
<p>On the other hand, it is theoretically also possible to add opacity species
without including this species in any of the chemistry models. In this case, the
abundance of this species will be zero and, thus, won’t show up in the spectrum.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/bear.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">BeAR - The Bern Atmospheric Retrieval code</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=daniel-kitzmann&repo=bear&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="licence.html">Licence</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="opacity_data.html">Opacity data</a></li>
<li class="toctree-l1"><a class="reference internal" href="observations.html">Observations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Forward Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#flat-line">Flat line</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transmission-spectrum">Transmission spectrum</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="retrieval_setup.html">Setting up a retrieval</a></li>
<li class="toctree-l1"><a class="reference internal" href="temperature_profiles.html">Temperature profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemistry_models.html">Chemistry Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloud_models.html">Cloud Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="stellar_spectra.html">Stellar spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="profile_parametrisations.html">Parametrisations of vertical profiles</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="observations.html" title="previous chapter">Observations</a></li>
      <li>Next: <a href="retrieval_setup.html" title="next chapter">Setting up a retrieval</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020 - 2024, Daniel Kitzmann.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/sections/forward_models.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>