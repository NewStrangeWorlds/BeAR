<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Forward Models &#8212; BeAR 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=5bc47236" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=359c27e9"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Prior distributions" href="priors.html" />
    <link rel="prev" title="Observations" href="observations.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="forward-models">
<span id="sec-forward-models"></span><h1>Forward Models<a class="headerlink" href="#forward-models" title="Permalink to this heading">¶</a></h1>
<p>BeAR currently includes the following forward models:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#sec-forward-model-transmission"><span class="std std-ref">Transmission spectrum</span></a></p></li>
<li><p><a class="reference internal" href="#sec-forward-model-em"><span class="std std-ref">Emission spectrum</span></a></p></li>
<li><p><a class="reference internal" href="#sec-forward-model-se"><span class="std std-ref">Secondary eclipse spectrum</span></a></p></li>
<li><p><a class="reference internal" href="#sec-forward-model-se-bb"><span class="std std-ref">Secondary eclipse spectra with a planetary blackbody</span></a></p></li>
<li><p><a class="reference internal" href="#sec-forward-model-flat"><span class="std std-ref">Flat line</span></a></p></li>
</ul>
</div></blockquote>
<p>The latter two models are usually used to check if the observational
data is more likely explained by more simpler models, such as a flat line.</p>
<p>Each model requires its own config file <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> that are
discussed below.</p>
<section id="model-postprocessing">
<h2>Model postprocessing<a class="headerlink" href="#model-postprocessing" title="Permalink to this heading">¶</a></h2>
<p>After the retrieval calculations are finished, the  BeAR will perform a postprocessing on
the resulting posterior sample. Depending on the chosen forward model, different
postprocessing steps can be used, including saving all posterior spectra or temperature
profiles. Details can be found in the <a class="reference internal" href="retrieval_setup.html#sec-output-files"><span class="std std-ref">section</span></a>
on output files.</p>
<p>These postprocessing steps can also be configured in the optional
<code class="docutils literal notranslate"><span class="pre">post_process.config</span></code> file. If this file is not present, BeAR will use
default settings for the postprocessing. Depending on the forward model,
available options are currently:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Delete</span> <span class="pre">unused</span> <span class="pre">MultiNest</span> <span class="pre">files</span></code> - This will option will delete all MultiNest files that
are not used in the post processing. Available options: <code class="docutils literal notranslate"><span class="pre">Yes</span></code> or <code class="docutils literal notranslate"><span class="pre">No</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">spectra</span></code> - Compute the spectra for each model in the posterior sample. Spectral
will be saved for each observational/instrument individually. Additionally, a high-resolution
spectrum of the best-fit model will be computed and saved. Available options: <code class="docutils literal notranslate"><span class="pre">Yes</span></code> or <code class="docutils literal notranslate"><span class="pre">No</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">temperature</span> <span class="pre">structures</span></code> - Compute and save the temperature profile for each model in the posterior
sample. Available options: <code class="docutils literal notranslate"><span class="pre">Yes</span></code> or <code class="docutils literal notranslate"><span class="pre">No</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">effective</span> <span class="pre">temperatures</span></code> - Compute and save the effective temperature for each model in posterior sample.
Available options: <code class="docutils literal notranslate"><span class="pre">Yes</span></code> or <code class="docutils literal notranslate"><span class="pre">No</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">contribution</span> <span class="pre">functions</span></code> - Compute and save the contribution functions for each observational/instrument
for the best-fit model. Available options: <code class="docutils literal notranslate"><span class="pre">Yes</span></code> or <code class="docutils literal notranslate"><span class="pre">No</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">chemical</span> <span class="pre">species</span></code> - Save the mixing ratio profiles for selected chemical species for all
posterior samples. The options for this parameter are the forumulas of the chemical species that should be saved,
separated by white spaces. For example, <code class="docutils literal notranslate"><span class="pre">H2O</span> <span class="pre">CO2</span></code> will save the mixing ratios of water and carbon dioxide.
Species that BeAR does not know will be ignored.</p></li>
</ul>
</div></blockquote>
</section>
<section id="flat-line">
<span id="sec-forward-model-flat"></span><h2>Flat line<a class="headerlink" href="#flat-line" title="Permalink to this heading">¶</a></h2>
<p>This model simply fits a flat line through the observational data. Usually, this
model is used to test if the use of a more complex model is warranted to explain
the observation. The test is normally done by comparing their
Bayesian evidences.</p>
<p>In the main retrieval config file <code class="docutils literal notranslate"><span class="pre">retrieval.config</span></code> it is selected by choosing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Forward model</span>
<span class="n">flat_line</span>
</pre></div>
</div>
<section id="model-config-file">
<h3>Model config file<a class="headerlink" href="#model-config-file" title="Permalink to this heading">¶</a></h3>
<p>The flat line model does not need a <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> file since it
has no configurable parameters. In the prior distribution file this model
requires a single free parameter that determines the flat line.</p>
<p>This parameter needs to have the same units as the observational data. For example,
in case of a transmission spectrum, this parameter refers to the transit depth in ppm, while
for an emission spectrum, it needs to have units of
<span class="math notranslate nohighlight">\(\mathrm{W} \mathrm{m^{-2}} \mathrm{\mu m^{-1}}\)</span>.</p>
</section>
<section id="id1">
<h3>Model postprocessing<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<p>The optional postprocessing file <code class="docutils literal notranslate"><span class="pre">post_process.config</span></code> has the following structure and
options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Delete unused MultiNest files</span>
<span class="n">Yes</span>

<span class="c1">#Compute spectra</span>
<span class="n">Yes</span>
</pre></div>
</div>
<p>The default options that are used when this file is not present are:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Delete</span> <span class="pre">unused</span> <span class="pre">MultiNest</span> <span class="pre">files</span></code> : No</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Compute</span> <span class="pre">spectra</span></code> : No</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="transmission-spectrum">
<span id="sec-forward-model-transmission"></span><h2>Transmission spectrum<a class="headerlink" href="#transmission-spectrum" title="Permalink to this heading">¶</a></h2>
<p>This forward model computes the wavelength-dependent transit depth
<span class="math notranslate nohighlight">\(D(\lambda)\)</span> of an exoplanet atmosphere, given by</p>
<div class="math notranslate nohighlight">
\[D(\lambda) = \left(\frac{R_p(\lambda)}{R_*}\right)^2 \ ,\]</div>
<p>where <span class="math notranslate nohighlight">\(R_p(\lambda)\)</span> is the wavelength-dependent planetary radius
and <span class="math notranslate nohighlight">\(R_*\)</span> the radius of the host star. In BeAR, <span class="math notranslate nohighlight">\(D(\lambda)\)</span>
has units of ppm.</p>
<p>In the retrieval config file <code class="docutils literal notranslate"><span class="pre">retrieval.config</span></code> it is selected by choosing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Forward model</span>
<span class="n">transmission</span>
</pre></div>
</div>
<p>The transmission spectrum forward model has three general free parameters that
have to be added to the priors configuration file in the following order:</p>
<blockquote>
<div><ul class="simple">
<li><p>logarithm of surface gravity <span class="math notranslate nohighlight">\(\log g\)</span> in cgs units</p></li>
<li><p>planet radius</p></li>
<li><p>stellar radius</p></li>
</ul>
</div></blockquote>
<section id="id2">
<h3>Model config file<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> file for the transmission spectrum model has
the following structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Number of levels</span>
<span class="mi">150</span>

<span class="c1">#Bottom of atmosphere pressure (bar)</span>
<span class="mi">10</span>

<span class="c1">#Top of atmosphere pressure (bar)</span>
<span class="mf">1e-6</span>

<span class="c1">#Fit for mean molecular weight (mmw) or scale height (sh)</span>
<span class="n">no</span>

<span class="c1">#Temperature profile</span>
<span class="n">const</span>

<span class="c1">#Cloud model</span>
<span class="n">none</span>

<span class="c1">#Optional modules</span>
<span class="n">none</span>

<span class="c1">#Retrieved chemical species</span>
<span class="n">iso</span> <span class="n">H2O</span> <span class="n">TiO</span> <span class="n">VO</span> <span class="n">K</span>
<span class="n">bg</span>  <span class="n">H2He</span>

<span class="c1">#Opacity species&amp;folders</span>
<span class="n">CIA</span><span class="o">-</span><span class="n">H2</span><span class="o">-</span><span class="n">H2</span>   <span class="n">CIA</span><span class="o">/</span><span class="n">H2</span><span class="o">-</span><span class="n">H2</span>
<span class="n">CIA</span><span class="o">-</span><span class="n">H2</span><span class="o">-</span><span class="n">He</span>   <span class="n">CIA</span><span class="o">/</span><span class="n">H2</span><span class="o">-</span><span class="n">He</span>
<span class="n">H2</span>          <span class="n">Rayleigh</span>
<span class="n">He</span>          <span class="n">Rayleigh</span>
<span class="n">H2O</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">1</span><span class="n">H2</span><span class="o">-</span><span class="mi">16</span><span class="n">O__POKAZATEL_e2b</span>
<span class="n">TiO</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">48</span><span class="n">Ti</span><span class="o">-</span><span class="mi">16</span><span class="n">O__Toto_e2b</span>
<span class="n">VO</span>          <span class="n">Molecules</span><span class="o">/</span><span class="mi">51</span><span class="n">V</span><span class="o">-</span><span class="mi">16</span><span class="n">O__VOMYT_e2b</span>
</pre></div>
</div>
<p>The first three entries refer to the vertical discretisation of the atmosphere.
This includes the number of atmospheric layers as well as the bottom and
top-of-atmosphere pressures in units of bars.</p>
<p>With the next entry, the retrieval of the mean molecular or the scale height
can be chosen. Usually, BeAR will determine the mean molecular based on
the chemical abundances of the species included in the retrieval.
Sometimes, however, the background species in an atmosphere might not be
known. For such a case, BeAR can use the mean molecular weight as a free
parameter.</p>
<p>Furthermore, for transmission spectra, the surface gravity, the mean molecular
weight, and the temperature might become degenerate in a retrieval. This is
often the case when no constraints on the surface gravity can be provided
and the dominating background species is not known. In such a scenario, BeAR
can use the (constant) atmospheric scale height in units of km as a free
parameter.</p>
<p>For the standard case, the keyword <code class="docutils literal notranslate"><span class="pre">no</span></code> needs to be used here. If BeAR should
use the mean molecular weight as a free parameter <code class="docutils literal notranslate"><span class="pre">mmw</span></code> is used, while
<code class="docutils literal notranslate"><span class="pre">sh</span></code> is used when the scale should be used as a free parameter instead. If either
the mean molecular weight or the scale height is chosen as a free parameter,
a corresponding prior needs to be added as a fourth model parameter in the
prior configuration file.</p>
<p>With the next two entries, the parametrisation for the
<a class="reference internal" href="temperature_profiles.html#sec-temperature-profiles"><span class="std std-ref">temperature profile</span></a> and
the <a class="reference internal" href="cloud_models.html#sec-cloud-models"><span class="std std-ref">cloud models</span></a> are set. After that, optional
modules can be added to the forward model.</p>
<p>Finally, the different <a class="reference internal" href="chemistry_models.html#sec-chemistry-models"><span class="std std-ref">chemistry models</span></a>, chemical species, and the
<a class="reference internal" href="opacity_data.html#sec-opacity-data"><span class="std std-ref">opacity sources</span></a> are selected. It is important to note that
chemical species that are used as part of the chemistry models, should normally also have
an associated opacity source. Otherwise, the impact of that species on the
resulting spectrum might be negligible and, therefore, its abundance will be
likely be unconstrained.</p>
<p>On the other hand, it is theoretically also possible to add opacity species
without including this species in any of the chemistry models. In this case, the
abundance of this species will be zero and, thus, won’t show up in the spectrum.</p>
</section>
<section id="id3">
<h3>Model postprocessing<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<p>The optional postprocessing file <code class="docutils literal notranslate"><span class="pre">post_process.config</span></code> has the following structure and
options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Delete unused MultiNest files</span>
<span class="n">Yes</span>

<span class="c1">#Compute spectra</span>
<span class="n">Yes</span>

<span class="c1">#Save temperature structures</span>
<span class="n">No</span>

<span class="c1">#Save chemical species</span>
<span class="n">none</span>
</pre></div>
</div>
<p>The default options that are used when this file is not present are:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Delete</span> <span class="pre">unused</span> <span class="pre">MultiNest</span> <span class="pre">files</span></code> : No</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Compute</span> <span class="pre">spectra</span></code> : Yes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">temperature</span> <span class="pre">structures</span></code> : No</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">chemical</span> <span class="pre">species</span></code> : None</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="secondary-eclipse-spectrum">
<span id="sec-forward-model-se"></span><h2>Secondary eclipse spectrum<a class="headerlink" href="#secondary-eclipse-spectrum" title="Permalink to this heading">¶</a></h2>
<p>This forward model computes the wavelength-dependent secondary eclipse (or occultation)
depth <span class="math notranslate nohighlight">\(D(\lambda)\)</span> of an exoplanet atmosphere, given by</p>
<div class="math notranslate nohighlight">
\[D(\lambda) = \frac{F_p(\lambda)}{F_*(\lambda)} \left(\frac{R_p}{R_*}\right)^2 \ ,\]</div>
<p>where <span class="math notranslate nohighlight">\(F_p(\lambda)\)</span> is the outgoing flux at top of the planet’s atmosphere,
<span class="math notranslate nohighlight">\(F_*(\lambda)\)</span> is the stellar photospheric flux, <span class="math notranslate nohighlight">\(R_p\)</span>
is the planetary radius and <span class="math notranslate nohighlight">\(R_*\)</span> the radius of the host star.
In BeAR, <span class="math notranslate nohighlight">\(D(\lambda)\)</span> has units of ppm.</p>
<p>In the retrieval config file <code class="docutils literal notranslate"><span class="pre">retrieval.config</span></code> it is selected by choosing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Forward model</span>
<span class="n">secondary_eclipse</span>
</pre></div>
</div>
<p>The secondary eclipse spectrum forward model has two general free parameters that
have to be added to the priors configuration file in the following order:</p>
<blockquote>
<div><ul class="simple">
<li><p>logarithm of surface gravity <span class="math notranslate nohighlight">\(\log g\)</span> in cgs units</p></li>
<li><p>ratio of the planet’s and stellar radius <span class="math notranslate nohighlight">\(\mathrm{R_p/R_*}\)</span></p></li>
</ul>
</div></blockquote>
<section id="id4">
<h3>Model config file<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> file for the secondary eclipse spectrum model has
the following structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Number of levels</span>
<span class="mi">70</span>

<span class="c1">#Bottom of atmosphere pressure (bar)</span>
<span class="mi">100</span>

<span class="c1">#Top of atmosphere pressure (bar)</span>
<span class="mf">1e-3</span>

<span class="c1">#Temperature profile</span>
<span class="n">poly</span> <span class="mi">6</span> <span class="mi">1</span>

<span class="c1">#stellar spectrum</span>
<span class="n">file</span> <span class="n">SecondaryEclipseExample</span><span class="o">/</span><span class="n">WASP</span><span class="o">-</span><span class="mf">43.</span><span class="n">dat</span>

<span class="c1">#cloud layer</span>
<span class="n">none</span>

<span class="c1">#Radiative transfer (scm/disort)</span>
<span class="n">scm</span>

<span class="c1">#Retrieved chemical species</span>
<span class="n">eq</span> <span class="n">fastchem_parameters</span><span class="o">.</span><span class="n">dat</span>

<span class="c1">#Opacity species&amp;folders</span>
<span class="n">CIA</span><span class="o">-</span><span class="n">H2</span><span class="o">-</span><span class="n">H2</span>   <span class="n">CIA</span><span class="o">/</span><span class="n">H2</span><span class="o">-</span><span class="n">H2</span>
<span class="n">CIA</span><span class="o">-</span><span class="n">H2</span><span class="o">-</span><span class="n">He</span>   <span class="n">CIA</span><span class="o">/</span><span class="n">H2</span><span class="o">-</span><span class="n">He</span>
<span class="n">Na</span>          <span class="n">Alkali_Allard</span><span class="o">/</span><span class="n">Na</span>
<span class="n">K</span>           <span class="n">Alkali_Allard</span><span class="o">/</span><span class="n">K</span>
<span class="n">H2O</span>         <span class="n">Molecules</span><span class="o">/</span><span class="n">H2O_pokazatel</span>
<span class="n">CO</span>          <span class="n">Molecules</span><span class="o">/</span><span class="mi">12</span><span class="n">C</span><span class="o">-</span><span class="mi">16</span><span class="n">O__Li2015_e2b</span>
<span class="n">TiO</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">48</span><span class="n">Ti</span><span class="o">-</span><span class="mi">16</span><span class="n">O__Toto_e2b</span>
<span class="n">VO</span>          <span class="n">Molecules</span><span class="o">/</span><span class="mi">51</span><span class="n">V</span><span class="o">-</span><span class="mi">16</span><span class="n">O__VOMYT_e2b</span>
<span class="n">SH</span>          <span class="n">Molecules</span><span class="o">/</span><span class="mi">32</span><span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="n">H__GYT_e2b</span>
<span class="n">H2S</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">1</span><span class="n">H2</span><span class="o">-</span><span class="mi">32</span><span class="n">S__AYT2_e2b</span>
<span class="n">FeH</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">56</span><span class="n">Fe</span><span class="o">-</span><span class="mi">1</span><span class="n">H__Yueqi_e2b</span>
<span class="n">CH4</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">12</span><span class="n">C</span><span class="o">-</span><span class="mi">1</span><span class="n">H4__YT34to10_e2b</span>
<span class="n">CO2</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">12</span><span class="n">C</span><span class="o">-</span><span class="mi">16</span><span class="n">O2__CDSD_4000_e2b</span>
<span class="n">HCN</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">1</span><span class="n">H</span><span class="o">-</span><span class="mi">12</span><span class="n">C</span><span class="o">-</span><span class="mi">14</span><span class="n">N__Harris_e2b</span>
<span class="n">MgH</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">26</span><span class="n">Mg</span><span class="o">-</span><span class="mi">1</span><span class="n">H__Yadin_e2b</span>
<span class="n">TiH</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">48</span><span class="n">Ti</span><span class="o">-</span><span class="mi">1</span><span class="n">H__MoLLIST_e2b</span>
<span class="n">CrH</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">52</span><span class="n">Cr</span><span class="o">-</span><span class="mi">1</span><span class="n">H__Yueqi_e2b</span>
<span class="n">CaH</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">40</span><span class="n">Ca</span><span class="o">-</span><span class="mi">1</span><span class="n">H__MoLLIST_e2b</span>

</pre></div>
</div>
<p>The first three entries refer to the vertical discretisation of the atmosphere.
This includes the number of atmospheric layers as well as the bottom and
top-of-atmosphere pressures in units of bars.</p>
<p>With the next two entries, the parametrisation for the <a class="reference internal" href="temperature_profiles.html#sec-temperature-profiles"><span class="std std-ref">temperature profile</span></a>,
the <a class="reference internal" href="stellar_spectra.html#sec-stellar-spectra"><span class="std std-ref">stellar spectrum</span></a>, and the <a class="reference internal" href="cloud_models.html#sec-cloud-models"><span class="std std-ref">cloud models</span></a> are set.</p>
<p>After that, the radiative transfer scheme is chosen. There are currently two
different options:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scm</span></code> - the short characteristic method, available for CPU and GPU</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">disort</span></code> - the discrete-ordinate solver DISORT, only available for CPU</p></li>
</ul>
</div></blockquote>
<p>Finally, the different <a class="reference internal" href="chemistry_models.html#sec-chemistry-models"><span class="std std-ref">chemistry models</span></a>, chemical species, and the
<a class="reference internal" href="opacity_data.html#sec-opacity-data"><span class="std std-ref">opacity sources</span></a> are selected. It is important to note that
chemical species that are used as part of the chemistry models, should normally also have
an associated opacity source. Otherwise, the impact of that species on the
resulting spectrum might be negligible and, therefore, its abundance will be
likely be unconstrained.</p>
<p>On the other hand, it is theoretically also possible to add opacity species
without including this species in any of the chemistry models. In this case, the
abundance of this species will be zero and, thus, won’t show up in the spectrum.</p>
</section>
<section id="id5">
<h3>Model postprocessing<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<p>The optional postprocessing file <code class="docutils literal notranslate"><span class="pre">post_process.config</span></code> has the following structure and
options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Delete unused MultiNest files</span>
<span class="n">Yes</span>

<span class="c1">#Save spectra</span>
<span class="n">Yes</span>

<span class="c1">#Save temperature structures</span>
<span class="n">Yes</span>

<span class="c1">#Save contribution functions</span>
<span class="n">No</span>

<span class="c1">#Save chemical species</span>
<span class="n">H2O</span> <span class="n">CO</span> <span class="n">CO2</span> <span class="n">CH4</span> <span class="n">NH3</span>
</pre></div>
</div>
<p>The default options that are used when this file is not present are:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Delete</span> <span class="pre">unused</span> <span class="pre">MultiNest</span> <span class="pre">files</span></code> : No</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Compute</span> <span class="pre">spectra</span></code> : Yes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">temperature</span> <span class="pre">structures</span></code> : Yes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">contribution</span> <span class="pre">functions</span></code> : No</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">chemical</span> <span class="pre">species</span></code> : None</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="secondary-eclipse-spectrum-with-planetary-blackbody">
<span id="sec-forward-model-se-bb"></span><h2>Secondary eclipse spectrum with planetary blackbody<a class="headerlink" href="#secondary-eclipse-spectrum-with-planetary-blackbody" title="Permalink to this heading">¶</a></h2>
<p>This forward model computes the wavelength-dependent secondary eclipse (or occultation)
depth <span class="math notranslate nohighlight">\(D(\lambda)\)</span> of an exoplanet atmosphere, given by</p>
<div class="math notranslate nohighlight">
\[D(\lambda) = \frac{F_p(\lambda)}{F_*(\lambda)} \left(\frac{R_p}{R_*}\right)^2 \ ,\]</div>
<p>where <span class="math notranslate nohighlight">\(F_p(\lambda)\)</span> is the outgoing flux at top of the planet’s atmosphere,
<span class="math notranslate nohighlight">\(F_*(\lambda)\)</span> is the stellar photospheric flux, <span class="math notranslate nohighlight">\(R_p\)</span>
is the planetary radius and <span class="math notranslate nohighlight">\(R_*\)</span> the radius of the host star.
In BeAR, <span class="math notranslate nohighlight">\(D(\lambda)\)</span> has units of ppm.</p>
<p>This model is a special case of the secondary eclipse spectrum model, where the planet’s flux
is assumed to be blackbody radiation. This is often used to test if the observational data warrants
a more complex model or when only a few, usually photometric, data points are available.</p>
<p>In the retrieval config file <code class="docutils literal notranslate"><span class="pre">retrieval.config</span></code> it is selected by choosing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Forward model</span>
<span class="n">secondary_eclipse_bb</span>
</pre></div>
</div>
<p>This forward model has two general free parameters that
have to be added to the priors configuration file in the following order:</p>
<blockquote>
<div><ul class="simple">
<li><p>the planet’s effective temperature in Kelvin</p></li>
<li><p>ratio of the planet’s and stellar radius <span class="math notranslate nohighlight">\(\mathrm{R_p/R_*}\)</span></p></li>
</ul>
</div></blockquote>
<section id="id6">
<h3>Model config file<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> file for the secondary eclipse spectrum model has
the following structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Stellar Spectrum</span>
<span class="n">blackbody</span>
</pre></div>
</div>
<p>It contains a single option related to description of the stellar spectrum. Information
on the available options can be found in the <a class="reference internal" href="stellar_spectra.html#sec-stellar-spectra"><span class="std std-ref">section</span></a> on stellar spectra.</p>
</section>
<section id="id7">
<h3>Model postprocessing<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h3>
<p>The optional postprocessing file <code class="docutils literal notranslate"><span class="pre">post_process.config</span></code> has the following structure and
options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Delete unused MultiNest files</span>
<span class="n">Yes</span>

<span class="c1">#Compute spectra</span>
<span class="n">Yes</span>
</pre></div>
</div>
<p>The default options that are used when this file is not present are:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Delete</span> <span class="pre">unused</span> <span class="pre">MultiNest</span> <span class="pre">files</span></code> : No</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Compute</span> <span class="pre">spectra</span></code> : Yes</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="emission-spectrum">
<span id="sec-forward-model-em"></span><h2>Emission spectrum<a class="headerlink" href="#emission-spectrum" title="Permalink to this heading">¶</a></h2>
<p>This forward model computes the emission spectrum <span class="math notranslate nohighlight">\(F(\lambda)\)</span> of an exoplanet or brown dwarf atmosphere.
In BeAR, <span class="math notranslate nohighlight">\(F(\lambda)\)</span> has units of <span class="math notranslate nohighlight">\(\mathrm{W} \mathrm{m^{-2}} \mathrm{\mu m^{-1}}\)</span>.</p>
<p>In the retrieval config file <code class="docutils literal notranslate"><span class="pre">retrieval.config</span></code> it is selected by choosing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Forward model</span>
<span class="n">emission</span>
</pre></div>
</div>
<p>The emission spectrum forward model has two general free parameters that
have to be added to the priors configuration file in the following order:</p>
<blockquote>
<div><ul class="simple">
<li><p>logarithm of surface gravity <span class="math notranslate nohighlight">\(\log g\)</span> in cgs units</p></li>
<li><p>a scaling factor <span class="math notranslate nohighlight">\(f\)</span> for the radius/distance relationship,
where the radius is internally set to 1 Jupiter radius</p></li>
<li><p>distance to the object</p></li>
</ul>
</div></blockquote>
<section id="id8">
<h3>Model config file<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> file for the emission spectrum model has
the following structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Number of levels</span>
<span class="mi">70</span>

<span class="c1">#Bottom of atmosphere pressure (bar)</span>
<span class="mi">300</span>

<span class="c1">#Top of atmosphere pressure (bar)</span>
<span class="mf">1e-3</span>

<span class="c1">#Temperature profile</span>
<span class="n">cubicbspline</span> <span class="mi">5</span>

<span class="c1">#Cloud model</span>
<span class="n">none</span>

<span class="c1">#Radiative transfer (scm/disort)</span>
<span class="n">scm</span>

<span class="c1">#Retrieved chemical species</span>
<span class="n">iso</span> <span class="n">H2O</span> <span class="n">CH4</span> <span class="n">NH3</span> <span class="n">K</span> <span class="n">H2S</span> <span class="n">CO2</span>
<span class="n">bg</span> <span class="n">H2He</span>

<span class="c1">#Opacity species&amp;folders</span>
<span class="n">CIA</span><span class="o">-</span><span class="n">H2</span><span class="o">-</span><span class="n">H2</span>   <span class="n">CIA</span><span class="o">/</span><span class="n">H2</span><span class="o">-</span><span class="n">H2</span>
<span class="n">CIA</span><span class="o">-</span><span class="n">H2</span><span class="o">-</span><span class="n">He</span>   <span class="n">CIA</span><span class="o">/</span><span class="n">H2</span><span class="o">-</span><span class="n">He</span>
<span class="n">K</span>           <span class="n">Alkali_Allard</span><span class="o">/</span><span class="n">K</span>
<span class="n">Na</span>          <span class="n">Alkali_Allard</span><span class="o">/</span><span class="n">Na</span>
<span class="n">H2O</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">1</span><span class="n">H2</span><span class="o">-</span><span class="mi">16</span><span class="n">O__POKAZATEL_e2b</span>
<span class="n">CH4</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">12</span><span class="n">C</span><span class="o">-</span><span class="mi">1</span><span class="n">H4__YT34to10_e2b</span>
<span class="n">NH3</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">14</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="n">H3__CoYuTe_e2b</span>
<span class="n">H2S</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">1</span><span class="n">H2</span><span class="o">-</span><span class="mi">32</span><span class="n">S__AYT2_e2b</span>
<span class="n">CO2</span>         <span class="n">Molecules</span><span class="o">/</span><span class="mi">12</span><span class="n">C</span><span class="o">-</span><span class="mi">16</span><span class="n">O2__CDSD_4000_e2b</span>

</pre></div>
</div>
<p>The first three entries refer to the vertical discretisation of the atmosphere.
This includes the number of atmospheric layers as well as the bottom and
top-of-atmosphere pressures in units of bars.</p>
<p>With the next two entries, the parametrisation for the
<a class="reference internal" href="temperature_profiles.html#sec-temperature-profiles"><span class="std std-ref">temperature profile</span></a> and
the <a class="reference internal" href="cloud_models.html#sec-cloud-models"><span class="std std-ref">cloud models</span></a> are set.</p>
<p>After that, the radiative transfer scheme is set. There are currently two
different options:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scm</span></code> - the short characteristic method, available for CPU and GPU</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">disort</span></code> - the discrete-ordinate solver DISORT, only available for CPU</p></li>
</ul>
</div></blockquote>
<p>Finally, the different <a class="reference internal" href="chemistry_models.html#sec-chemistry-models"><span class="std std-ref">chemistry models</span></a>, chemical species, and the
<a class="reference internal" href="opacity_data.html#sec-opacity-data"><span class="std std-ref">opacity sources</span></a> are selected. It is important to note that
chemical species that are used as part of the chemistry models, should normally also have
an associated opacity source. Otherwise, the impact of that species on the
resulting spectrum might be negligible and, therefore, its abundance will be
likely be unconstrained.</p>
<p>On the other hand, it is theoretically also possible to add opacity species
without including this species in any of the chemistry models. In this case, the
abundance of this species will be zero and, thus, won’t show up in the spectrum.</p>
</section>
<section id="id9">
<h3>Model postprocessing<a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h3>
<p>The optional postprocessing file <code class="docutils literal notranslate"><span class="pre">post_process.config</span></code> has the following structure and
options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Delete unused MultiNest files</span>
<span class="n">Yes</span>

<span class="c1">#Save spectra</span>
<span class="n">Yes</span>

<span class="c1">#Save temperature structures</span>
<span class="n">Yes</span>

<span class="c1">#Save effective temperatures</span>
<span class="n">Yes</span>

<span class="c1">#Save contribution functions</span>
<span class="n">No</span>

<span class="c1">#Save chemical species</span>
<span class="n">none</span>
</pre></div>
</div>
<p>The default options that are used when this file is not present are:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Delete</span> <span class="pre">unused</span> <span class="pre">MultiNest</span> <span class="pre">files</span></code> : No</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Compute</span> <span class="pre">spectra</span></code> : Yes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">temperature</span> <span class="pre">structures</span></code> : Yes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">effective</span> <span class="pre">temperatures</span></code> : Yes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">contribution</span> <span class="pre">functions</span></code> : No</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">chemical</span> <span class="pre">species</span></code> : None</p></li>
</ul>
</div></blockquote>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/bear.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">BeAR - The Bern Atmospheric Retrieval code</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=daniel-kitzmann&repo=bear&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="licence.html">Licence</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="opacity_data.html">Opacity data</a></li>
<li class="toctree-l1"><a class="reference internal" href="observations.html">Observations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Forward Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#model-postprocessing">Model postprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#flat-line">Flat line</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transmission-spectrum">Transmission spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="#secondary-eclipse-spectrum">Secondary eclipse spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="#secondary-eclipse-spectrum-with-planetary-blackbody">Secondary eclipse spectrum with planetary blackbody</a></li>
<li class="toctree-l2"><a class="reference internal" href="#emission-spectrum">Emission spectrum</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="priors.html">Prior distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="retrieval_setup.html">Setting up and starting a retrieval</a></li>
<li class="toctree-l1"><a class="reference internal" href="temperature_profiles.html">Temperature profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemistry_models.html">Chemistry Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloud_models.html">Cloud Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="stellar_spectra.html">Stellar spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="profile_parametrisations.html">Parametrisations of vertical profiles</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="observations.html" title="previous chapter">Observations</a></li>
      <li>Next: <a href="priors.html" title="next chapter">Prior distributions</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020 - 2024, Daniel Kitzmann.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/sections/forward_models.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>