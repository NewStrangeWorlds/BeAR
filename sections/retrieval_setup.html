<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Setting up a retrieval &#8212; BeAR 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=5bc47236" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=359c27e9"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Forward Models" href="forward_models.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="setting-up-a-retrieval">
<h1>Setting up a retrieval<a class="headerlink" href="#setting-up-a-retrieval" title="Permalink to this heading">¶</a></h1>
<p>To start a retrieval calculation, BeAR requires the following files in the folder the executable is called with:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">retrieval.config</span></code> - the main configuration file for the retrieval</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forward_model.config</span></code> - the configuration file of chosen forward forward_model</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prior.config</span></code> - the setup list for the prior distributions of the free parameters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">observations.list</span></code> - the list of observational data files that the retrieval should use</p></li>
</ul>
</div></blockquote>
<section id="main-retrieval-file">
<h2>Main retrieval file<a class="headerlink" href="#main-retrieval-file" title="Permalink to this heading">¶</a></h2>
<p>The file <code class="docutils literal notranslate"><span class="pre">retrieval.config</span></code> contains the basic information for the retrieval setup.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">################</span>
<span class="c1">#General config#</span>
<span class="c1">################</span>
<span class="c1">#Use GPU</span>
<span class="n">Y</span>

<span class="c1">#OpenMP processor number (if 0, use maximum)</span>
<span class="mi">0</span>

<span class="c1">#########################</span>
<span class="n">General</span> <span class="n">retrieval</span> <span class="n">config</span><span class="c1">#</span>
<span class="c1">#########################</span>

<span class="c1">#forward model type</span>
<span class="n">secondary_eclipse</span>

<span class="c1">#Spectral resolution (cm-1)</span>
<span class="mf">1.0</span>

<span class="c1">#Opacity data folder</span>
<span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">opacity_data</span><span class="o">/</span><span class="n">helios</span><span class="o">-</span><span class="n">k</span><span class="o">/</span>

<span class="c1">#Use error inflation prior</span>
<span class="n">N</span>

<span class="c1">#####################</span>
<span class="c1">#Multinest parameter#</span>
<span class="c1">#####################</span>
<span class="c1">#Importance nested sampling</span>
<span class="n">Y</span>

<span class="c1">#Mode separation</span>
<span class="n">N</span>

<span class="c1">#Number of live points</span>
<span class="mi">800</span>

<span class="c1">#Efficiency</span>
<span class="mf">0.8</span>

<span class="c1">#Maximum number of iterations (0 for no limit)</span>
<span class="mi">0</span>

<span class="c1">#Resume</span>
<span class="n">N</span>

<span class="c1">#Console feedback</span>
<span class="n">Y</span>

<span class="c1">#Print parameter values and likelihoods</span>
<span class="n">Y</span>

</pre></div>
</div>
<p>The following parameters need to be set:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Use</span> <span class="pre">GPU</span></code></div>
<div class="line-block">
<div class="line">Determines the use of the graphics card. Set either <code class="docutils literal notranslate"><span class="pre">Y</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> to run the calculation on the GPU.
Any other input is interpreted as running purely on the CPU.</div>
</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">OpenMP</span> <span class="pre">processor</span> <span class="pre">number</span></code></div>
<div class="line-block">
<div class="line">Sets the number of processor cores used for parallel computing on the CPU. Some parts
of BeAR will still run on the CPU, even if <code class="docutils literal notranslate"><span class="pre">Use</span> <span class="pre">GPU</span></code> is enabled. This, for example, is the case for the
FastChem chemistry code that doesn’t run GPUs. BeAR will run certain calculations in parallel on the CPU as well, using
OpenMP. Set this parameter to <code class="docutils literal notranslate"><span class="pre">0</span></code> if you want to use all available cores. Note that OpenMP can only use a single,
multi-core processor.</div>
</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">forward</span> <span class="pre">model</span> <span class="pre">type</span></code></div>
<div class="line-block">
<div class="line">Sets the forward model that is supppsed to be used. BeAR currently supports the following models:</div>
</div>
</div>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">transmission</span></code> - Transmission spectrum</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secondary_eclipse</span></code> - Secondary eclipse / occulation spectrum</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">emission</span></code> - Emission spectrum</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flat_line</span></code> - Fits a flat line to the data</p></li>
</ul>
</div></blockquote>
<p>Descriptions of the forward models can be found <a class="reference internal" href="opacity_data.html#sec-opacity-data"><span class="std std-ref">here</span></a></p>
</div></blockquote>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Spectral</span> <span class="pre">resolution</span></code></div>
<div class="line-block">
<div class="line">Sets the constant step in wavenumber space that will be used for the computation of the
high-resolution spectrum. Note that this high-resolution grid should generally be finer than that of the
observational data.</div>
</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Opacity</span> <span class="pre">data</span> <span class="pre">folder</span></code></div>
<div class="line-block">
<div class="line">Location of the folder with opacities for the gas species. Details on the required format
of the opacity data can be found in this <a class="reference internal" href="opacity_data.html#sec-opacity-data"><span class="std std-ref">section</span></a></div>
</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Use</span> <span class="pre">error</span> <span class="pre">inflation</span> <span class="pre">prior</span></code></div>
<div class="line-block">
<div class="line">Determines the use of the error inflation. This will artifically enlarge the error bars of the
observational data and, thus, will generally make it easier for the retrieval to find a
solution. The use of the error inflation acknowledges that certain physical or chemical processes
are missing from the simple forward model of the retrieval. The form of the employed error inflation
is described in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2020ApJ...890..174K/">Kitzmann et al. (2020)</a></div>
</div>
</div>
<p>The remaining parameters refer to the nested-sampling code MultiNest. For a description of the MultiNest code
and its parameters, we refer to <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2008MNRAS.384..449F/">Feroz &amp; Hobs (2009)</a>
and <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2009MNRAS.398.1601F/">Feroz et al. (2008)</a> .</p>
<p>The parameters that can be set here include:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Importance</span> <span class="pre">nested</span> <span class="pre">sampling</span></code></div>
<div class="line-block">
<div class="line">Turns the use of importance nested sampling on or off. To use importance nested sampling, set this parameter
to either <code class="docutils literal notranslate"><span class="pre">Y</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>. Any other value is interpreted as <code class="docutils literal notranslate"><span class="pre">N</span></code>. Importance nested sampling requires
a bit more memory but, on the other hand, also increases the convergence speed and
the overall accuracy of the Bayesian evidence calculation. Unless memory is a real
bottleneck, there should be no reason to deactivate important nested sampling.</div>
</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Mode</span> <span class="pre">separation</span></code></div>
<div class="line-block">
<div class="line">MultiNest has the ability to trace different modes in a posterior distribution and to save them separately.
This option turns the use of mode separation on or off. To use it, set this parameter
to either <code class="docutils literal notranslate"><span class="pre">Y</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>. Any other value is interpreted as <code class="docutils literal notranslate"><span class="pre">N</span></code>. Note that this option in untested and
might not work properly.</div>
</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Number</span> <span class="pre">of</span> <span class="pre">live</span> <span class="pre">points</span></code></div>
<div class="line-block">
<div class="line">Sets the number of live points uses by MultiNest. Generally speaking, a high-dimensional parameter space
requires a higher amount of live points. It is strongly recommended to perform sensitivy tests by
increasing this number and check if the posterior distributions have converged.</div>
</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Efficiency</span></code></div>
<div class="line-block">
<div class="line">Sets the efficiency that determines the way MultiNest draws new points from the parameter space.
For more details on this parameter check the MultiNest documentation. The authors of MultiNest suggest
to use an efficiency of <code class="docutils literal notranslate"><span class="pre">0.8</span></code> for parameter estimations and <code class="docutils literal notranslate"><span class="pre">0.3</span></code> when the Bayesian evidence is
wanted at a high accuracy.</div>
</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Maximum</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">iterations</span></code></div>
<div class="line-block">
<div class="line">The maximum number of iterations MultiNest will use before the nested sampling is stopped.
A value of <code class="docutils literal notranslate"><span class="pre">0</span></code> indicates that MultiNest will perform the nested sampling until its convergence criteria are met.</div>
</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Resume</span></code></div>
<div class="line-block">
<div class="line">If this is set to <code class="docutils literal notranslate"><span class="pre">Y</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>, MultiNest will try to resume a previously started retrieval run. The files MultiNest
needs to restart the nested sampling must all be present in the retrieval folder. This option is usefull if BeAR
is run on a cluster with a strict time limit. A restart can also be used if a previous MultiNest run was stopped
at its maximum number of iterations.</div>
</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Console</span> <span class="pre">feedback</span></code></div>
<div class="line-block">
<div class="line">MultiNest will regularly report the current total number of model evaluations and estimates for the Bayesian evidences
when this option is turned on with <code class="docutils literal notranslate"><span class="pre">Y</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>.</div>
</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Print</span> <span class="pre">parameter</span> <span class="pre">values</span> <span class="pre">and</span> <span class="pre">likelihoods</span></code></div>
<div class="line-block">
<div class="line">Determines whether the parameter values and the computed likelihood values for all models should be displayed
(<code class="docutils literal notranslate"><span class="pre">Y</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>).  If BeAR is run on a cluster and the terminal output is redirected to a file,
it is usually a good idea to deactivate this option. Otherwise, the output file could become quite large.</div>
</div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/bear.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">BeAR - The Bern Atmospheric Retrieval code</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=daniel-kitzmann&repo=bear&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="licence.html">Licence</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="opacity_data.html">Opacity data</a></li>
<li class="toctree-l1"><a class="reference internal" href="observations.html">Observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="forward_models.html">Forward Models</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setting up a retrieval</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#main-retrieval-file">Main retrieval file</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="forward_models.html" title="previous chapter">Forward Models</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020 - 2024, Daniel Kitzmann.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/sections/retrieval_setup.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>